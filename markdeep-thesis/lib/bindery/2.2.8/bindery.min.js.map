{"version":3,"file":"bindery.min.js","sources":["../src/viewer/error.js","../src/dom-utils/prefixer.js","../src/constants/paper.js","../src/constants/modes.js","../src/constants/layout.js","../src/constants/marks.js","../src/dom-utils/classes.js","../src/dom-utils/createEl.js","../src/dom-utils/safeMeasure.js","../src/dom-utils/index.js","../src/css-length/index.js","../src/page-setup/defaultPageSetup.js","../src/page-setup/PageSetup.js","../src/rules/Rule.js","../src/option-checker/validate.js","../src/option-checker/types.js","../src/rules/Counter.js","../src/rules/OutOfFlow.js","../src/rules/FullBleedSpread.js","../src/rules/FullBleedPage.js","../src/rules/Replace.js","../src/rules/Footnote.js","../src/rules/searchPages.js","../src/utils/shallowEqual.js","../src/utils/throttle.js","../src/rules/PageReference.js","../src/rules/PageBreak.js","../src/rules/RunningHeader.js","../src/rules/Split.js","../src/rules/index.js","../src/defaults/attributeRules.js","../node_modules/regionize/dist/regionize.esm.js","../src/book/Page.js","../src/book/orderPages.js","../src/book/Book.js","../src/book/annotatePages.js","../src/makeBook/dedupeRules.js","../src/makeBook/recoverFromRule.js","../src/makeBook/RuleSet.js","../src/makeBook/estimateProgress.js","../src/makeBook/makeBook.js","../src/layouts/padPages.js","../src/layouts/gridLayout.js","../src/layouts/printMarks.js","../src/layouts/orderPagesBooklet.js","../src/layouts/printLayout.js","../src/layouts/flipLayout.js","../src/viewer/listenForPrint.js","../src/viewer/Viewer.js","../src/bindery.js","../src/index.js"],"sourcesContent":["/* global BINDERY_VERSION */\n\nimport { createEl } from '../dom-utils';\n\nexport default function (title, text) {\n  return createEl('.error', [\n    createEl('.error-title', title),\n    createEl('.error-text', text),\n    createEl('.error-footer', `Bindery ${BINDERY_VERSION}`),\n  ]);\n}\n","//\n// prefix classes\nconst p = 'ðŸ“–-';\n\nconst prefix = str => `${p}${str}`;\nconst prefixClass = str => `.${prefix(str)}`;\n\nconst prefixer = (str) => {\n  if (str[0] === '.') {\n    return prefixClass(str.substr(1));\n  }\n  return prefix(str);\n};\n\nexport default prefixer;\n","const AUTO = 1;\nconst AUTO_BLEED = 2;\nconst AUTO_MARKS = 3;\nconst LETTER_PORTRAIT = 4;\nconst LETTER_LANDSCAPE = 5;\nconst A4_PORTRAIT = 6;\nconst A4_LANDSCAPE = 7;\n\nexport {\n  AUTO,\n  AUTO_BLEED,\n  AUTO_MARKS,\n  LETTER_PORTRAIT,\n  LETTER_LANDSCAPE,\n  A4_PORTRAIT,\n  A4_LANDSCAPE,\n};\n","const FLIPBOOK = 1;\nconst PREVIEW = 2;\nconst PRINT = 3;\n\nexport { FLIPBOOK, PREVIEW, PRINT };\n","const PAGES = 1;\nconst SPREADS = 2;\nconst BOOKLET = 3;\n\nexport { PAGES, BOOKLET, SPREADS };\n","const NONE = 1;\nconst CROP = 2;\nconst BLEED = 3;\nconst BOTH = 4;\n\nexport { NONE, CROP, BLEED, BOTH };\n","import prefix from './prefixer';\nimport { Mode } from '../constants';\n\nconst classes = {\n  showBleed: 'show-bleed',\n  showCrop: 'show-crop',\n  showBleedMarks: 'show-bleed-marks',\n\n  isViewing: 'viewing',\n  viewPreview: 'view-preview',\n  viewPrint: 'view-print',\n  viewFlip: 'view-flip',\n  inProgress: 'in-progress',\n\n  leftPage: 'left',\n  rightPage: 'right',\n  isOverflowing: 'is-overflowing',\n\n  printSheet: 'print-sheet',\n  sheetSpread: 'print-sheet-spread',\n  sheetLeft: 'print-sheet-left',\n  sheetRight: 'print-sheet-right',\n\n  toNext: 'continues',\n  fromPrev: 'continuation',\n};\n\nObject.keys(classes).forEach((k) => {\n  const val = classes[k];\n  classes[k] = prefix(val);\n});\n\nclasses.allModes = [classes.viewPreview, classes.viewPrint, classes.viewFlip];\nclasses[Mode.PREVIEW] = classes.viewPreview;\nclasses[Mode.PRINT] = classes.viewPrint;\nclasses[Mode.FLIPBOOK] = classes.viewFlip;\n\nexport default classes;\n","import prefixer from './prefixer';\n\nconst doc = window.document;\n// Create div with prefixed classes\nconst createEl = (className, content = []) => {\n  const div = doc.createElement('div');\n  div.className = className.split('.').filter(txt => txt !== '').map(prefixer).join(' ');\n\n  if (typeof content === 'string') {\n    div.textContent = content;\n  } else if (Array.isArray(content)) {\n    content.forEach(child => div.appendChild(child));\n  }\n  return div;\n};\n\nexport default createEl;\n","import c from './prefixer';\nimport createEl from './createEl';\n\nconst safeMeasure = (el, measure) => {\n  if (el.parentNode) return measure();\n  let measureArea = document.querySelector(c('.measure-area'));\n  if (!measureArea) measureArea = document.body.appendChild(createEl('measure-area'));\n  if (measureArea.firstElementChild !== el) {\n    measureArea.innerHTML = '';\n    measureArea.appendChild(el);\n  }\n  const result = measure();\n  return result;\n};\n\nexport default safeMeasure;\n","import classes from './classes';\nimport prefixer from './prefixer';\nimport safeMeasure from './safeMeasure';\nimport createEl from './createEl';\n\nconst doc = window.document;\n\n// Create stylesheet with id\nconst addStylesheet = (id) => {\n  const style = doc.createElement('style');\n  style.id = id;\n  doc.head.appendChild(style);\n  return style;\n};\n\n// Fetch or create stylesheet with id\nconst stylesheet = id => doc.querySelector(`#${id}`) || addStylesheet(id);\n\n// Parse html from text\nconst parseHTML = (text, selector) => {\n  const wrapper = doc.createElement('div');\n  wrapper.innerHTML = text;\n  return wrapper.querySelector(selector);\n};\n\nconst c = prefixer;\nexport { c, classes, createEl, stylesheet, safeMeasure, parseHTML };\n","const cssNumberRegEx = /^([+-]?[0-9]+(.?[0-9]+)?)(px|in|cm|mm|pt|pc)$/;\n\nconst isLength = str => cssNumberRegEx.test(str);\n\nconst parseLength = (str) => {\n  if (!isLength(str)) throw Error(`Cannot parse css length from \"${str}\"`);\n\n  const matches = str.match(cssNumberRegEx);\n  return {\n    val: Number(matches[1]),\n    unit: matches[3],\n  };\n};\n\nexport { parseLength, isLength };\n","export default {\n  bleed: '12pt',\n  size: { width: '4in', height: '6in' },\n  margin: {\n    inner: '24pt',\n    outer: '24pt',\n    bottom: '40pt',\n    top: '48pt',\n  },\n};\n","import { stylesheet } from '../dom-utils';\nimport { parseLength } from '../css-length';\n\nimport defaultPageSetup from './defaultPageSetup';\nimport { Paper, Layout } from '../constants';\n\nconst letter = Object.freeze({ width: '8.5in', height: '11in' });\nconst a4 = Object.freeze({ width: '210mm', height: '297mm' });\n\nconst supportsCustomPageSize = !!window.chrome;\n\nclass PageSetup {\n  constructor(opts = {}, printOpts = {}) {\n    this.size = opts.size || defaultPageSetup.size;\n    this.margin = opts.margin || defaultPageSetup.margin;\n    this.markLength = '12pt';\n\n    this.paper = supportsCustomPageSize ? (printOpts.paper || Paper.AUTO) : Paper.AUTO_MARKS;\n    this.bleed = printOpts.bleed || defaultPageSetup.bleed;\n    this.printTwoUp = printOpts.layout && printOpts.layout !== Layout.PAGES;\n  }\n\n  get displaySize() {\n    const width = this.printTwoUp ? this.spreadSize.width : this.size.width;\n    const height = this.size.height;\n    const bleed = this.bleed;\n\n    return { width, height, bleed };\n  }\n\n  get sheetSize() {\n    const width = this.printTwoUp ? this.spreadSize.width : this.size.width;\n    const height = this.size.height;\n\n    const doubleBleed = `2 * ${this.bleed}`;\n    const doubleMarks = `${doubleBleed} + 2 * ${this.markLength}`;\n    const singleMarks = `${this.bleed} + ${this.markLength}`;\n    switch (this.paper) {\n    case Paper.AUTO:\n      return { width, height };\n    case Paper.AUTO_BLEED:\n      return {\n        width: `calc(${width} + ${this.printTwoUp ? doubleBleed : this.bleed})`,\n        height: `calc(${height} + ${doubleBleed})`,\n      };\n    case Paper.AUTO_MARKS:\n      return {\n        width: `calc(${width} + ${this.printTwoUp ? doubleMarks : singleMarks})`,\n        height: `calc(${height} + ${doubleMarks})`,\n      };\n    case Paper.LETTER_LANDSCAPE:\n      return { width: letter.height, height: letter.width };\n    case Paper.LETTER_PORTRAIT:\n      return letter;\n    case Paper.A4_PORTRAIT:\n      return a4;\n    case Paper.A4_LANDSCAPE:\n      return { width: a4.height, height: a4.width };\n    default:\n    }\n    return { width, height };\n  }\n\n  get spreadSize() {\n    const w = parseLength(this.size.width);\n    return {\n      height: this.size.height,\n      width: `${w.val * 2}${w.unit}`,\n    };\n  }\n\n  updateStyleVars() {\n    const page = this.size;\n    const sheet = this.sheetSize;\n    const vars = {\n      'spread-width': this.spreadSize.width,\n      'page-width': page.width,\n      'page-height': page.height,\n      'sheet-width': sheet.width,\n      'sheet-height': sheet.height,\n      'margin-inner': this.margin.inner,\n      'margin-outer': this.margin.outer,\n      'margin-top': this.margin.top,\n      'margin-bottom': this.margin.bottom,\n      bleed: this.bleed,\n      'mark-length': this.markLength,\n    };\n    const str = Object.keys(vars).map(k => `--bindery-${k}: ${vars[k]};`).join('');\n\n    const rootRule = `:root { ${str} }`;\n    const pageRule = `@page { size: ${sheet.width} ${sheet.height}; }`;\n\n    stylesheet('binderyPage').innerHTML = `${rootRule} ${pageRule}`;\n  }\n}\n\nexport default PageSetup;\n","export default class Rule {\n  constructor(options) {\n    this.name = options.name ? options.name : 'Unnamed Bindery Rule';\n    this.selector = '';\n\n    Object.keys(options).forEach((key) => {\n      this[key] = options[key];\n    });\n  }\n}\n","const validate = (opts, validOpts) => {\n  if (!validOpts) throw Error('Valid options not specified');\n\n  Object.keys(opts).forEach((k) => {\n    if (!validOpts[k]) {\n      const setName = validOpts.name ? `'${validOpts.name}'` : 'This option';\n      throw Error(`Unknown option in ${setName}: '${k}'`);\n    }\n    const val = opts[k];\n    const type = validOpts[k];\n    if (!type.check(val)) {\n      const optName = validOpts.name ? `${validOpts.name}.${k}` : k;\n      throw Error(`Invalid value for '${optName}': ${JSON.stringify(val)} is not a ${type.name}.`);\n    }\n  });\n  return true;\n};\n\nexport default validate;\n","import { isLength } from '../css-length';\nimport validate from './validate';\n\nconst isObj = val => typeof val === 'object';\nconst isFunc = val => typeof val === 'function';\nconst isBool = val => typeof val === 'boolean';\nconst isStr = val => typeof val === 'string';\nconst isNum = val => typeof val === 'number';\nconst isArr = val => Array.isArray(val);\n\nconst hasProp = (obj, k) => Object.prototype.hasOwnProperty.call(obj, k);\n\nconst hasSameKeys = (opts, required) => {\n  const keys = Object.keys(required).filter(k => k !== 'name');\n  return !keys.some(k => !hasProp(opts, k));\n};\n\nconst isShape = template => input => isObj(input) && validate(input, template);\n\nconst isShapeExact = template => input => isObj(input)\n  && hasSameKeys(input, template)\n  && validate(input, template);\n\nconst isEnum = cases => str => cases.includes(str);\n\nconst T = {\n  any: {\n    name: 'any',\n    check: () => true,\n  },\n  enum(...cases) {\n    return {\n      name: `(${cases.map(c => `\"${c}\"`).join(' | ')})`,\n      check: isEnum(cases),\n    };\n  },\n  shapeExact: template => ({\n    name: `exactly ({${Object.keys(template).join(', ')}})`,\n    check: isShapeExact(template),\n  }),\n  shape: template => ({\n    name: `shape ({${Object.keys(template).join(', ')}})`,\n    check: isShape(template),\n  }),\n  string: {\n    name: 'string',\n    check: isStr,\n  },\n  length: {\n    name: 'length (string with absolute units)',\n    check: isLength,\n  },\n  number: {\n    name: 'number',\n    check: isNum,\n  },\n  bool: {\n    name: 'bool',\n    check: isBool,\n  },\n  func: {\n    name: 'func',\n    check: isFunc,\n  },\n  obj: {\n    name: 'object',\n    check: isObj,\n  },\n  array: {\n    name: 'array',\n    check: isArr,\n  },\n};\n\nT.margin = {\n  name: 'margin ({ top, inner, outer, bottom })',\n  check: isShapeExact({\n    name: 'margin',\n    top: T.length,\n    inner: T.length,\n    outer: T.length,\n    bottom: T.length,\n  }),\n};\n\nT.size = {\n  name: 'size ({ width, height })',\n  check: isShapeExact({\n    name: 'size',\n    width: T.length,\n    height: T.length,\n  }),\n};\n\nexport default T;\n","import Rule from './Rule';\nimport { validate, T } from '../option-checker';\n\n\nclass Counter extends Rule {\n  constructor(options) {\n    super(options);\n    this.selector = '*';\n    this.counterValue = 0;\n    validate(options, {\n      name: 'Counter',\n      replaceEl: T.string,\n      resetEl: T.string,\n      incrementEl: T.string,\n      replace: T.func,\n    });\n  }\n  setup() {\n    this.counterValue = 0;\n  }\n  beforeAdd(el) {\n    if (el.matches(this.incrementEl)) this.counterValue += 1;\n    if (el.matches(this.resetEl)) this.counterValue = 0;\n    if (el.matches(this.replaceEl)) return this.createReplacement(el);\n    return el;\n  }\n  createReplacement(element) {\n    return this.replace(element, this.counterValue);\n  }\n  replace(element, counterValue) {\n    element.textContent = counterValue;\n    return element;\n  }\n}\n\nexport default Counter;\n","import Rule from './Rule';\n\nclass OutOfFlow extends Rule {\n  constructor(options) {\n    super(options);\n    this.name = 'Out of Flow';\n  }\n  beforeAdd(elmt) {\n    // Avoid breaking inside this element. Once it's completely added,\n    // it will moved onto the background layer.\n\n    elmt.setAttribute('data-ignore-overflow', true);\n    return elmt;\n  }\n  afterAdd(elmt, book, continueOnNewPage, makeNewPage) {\n    this.createOutOfFlowPages(elmt, book, makeNewPage);\n\n    // Catches cases when we didn't need to create a new page. but unclear\n    if (this.continue !== 'same' || book.currentPage.hasOutOfFlowContent) {\n      continueOnNewPage(true);\n      if (this.continue === 'left' || this.continue === 'right') {\n        book.currentPage.setPreference(this.continue);\n      }\n    }\n\n    return elmt;\n  }\n}\n\nexport default OutOfFlow;\n","import OutOfFlow from './OutOfFlow';\nimport { validate, T } from '../option-checker';\nimport { c, createEl } from '../dom-utils';\n\n// Options:\n// selector: String\n\nclass FullBleedSpread extends OutOfFlow {\n  constructor(options) {\n    options.continue = options.continue || 'same';\n    options.rotate = options.rotate || 'none';\n    super(options);\n    validate(options, {\n      name: 'FullBleedSpread',\n      selector: T.string,\n      continue: T.enum('next', 'same', 'left', 'right'),\n      rotate: T.enum('none', 'clockwise', 'counterclockwise'),\n    });\n  }\n  createOutOfFlowPages(elmt, book, makeNewPage) {\n    elmt.parentNode.removeChild(elmt);\n\n    let leftPage;\n    if (book.currentPage.isEmpty) {\n      leftPage = book.currentPage;\n    } else {\n      leftPage = makeNewPage();\n      book.addPage(leftPage);\n    }\n\n    const rightPage = makeNewPage();\n    book.addPage(rightPage);\n\n    if (this.rotate !== 'none') {\n      [leftPage, rightPage].forEach((page) => {\n        const rotateContainer = createEl(`.rotate-container.spread-size-rotated.rotate-spread-${this.rotate}`);\n        rotateContainer.appendChild(page.background);\n        page.element.appendChild(rotateContainer);\n      });\n    }\n\n    leftPage.background.appendChild(elmt);\n    leftPage.element.classList.add(c('spread'));\n    leftPage.setPreference('left');\n    leftPage.isOutOfFlow = this.continue === 'same';\n    leftPage.avoidReorder = true;\n    leftPage.hasOutOfFlowContent = true;\n\n    rightPage.background.appendChild(elmt.cloneNode(true));\n    rightPage.element.classList.add(c('spread'));\n    rightPage.setPreference('right');\n    rightPage.isOutOfFlow = this.continue === 'same';\n    rightPage.avoidReorder = true;\n    rightPage.hasOutOfFlowContent = true;\n  }\n}\n\nexport default FullBleedSpread;\n","import OutOfFlow from './OutOfFlow';\nimport { validate, T } from '../option-checker';\nimport { createEl } from '../dom-utils';\n\n// Options:\n// selector: String\n\nclass FullBleedPage extends OutOfFlow {\n  constructor(options) {\n    options.continue = options.continue || 'same';\n    options.rotate = options.rotate || 'none';\n    super(options);\n    validate(options, {\n      name: 'FullBleedPage',\n      selector: T.string,\n      continue: T.enum('next', 'same', 'left', 'right'),\n      rotate: T.enum('none', 'inward', 'outward', 'clockwise', 'counterclockwise'),\n    });\n  }\n\n  createOutOfFlowPages(elmt, book, makeNewPage) {\n    elmt.parentNode.removeChild(elmt);\n\n    let newPage;\n    if (book.currentPage.isEmpty) {\n      newPage = book.currentPage;\n    } else {\n      newPage = makeNewPage();\n      book.addPage(newPage);\n    }\n    if (this.rotate !== 'none') {\n      const rotateContainer = createEl(`.rotate-container.page-size-rotated.rotate-${this.rotate}`);\n      rotateContainer.appendChild(newPage.background);\n      newPage.element.appendChild(rotateContainer);\n    }\n    newPage.background.appendChild(elmt);\n    newPage.hasOutOfFlowContent = true;\n  }\n}\n\nexport default FullBleedPage;\n","import Rule from './Rule';\n\n// Options:\n// selector: String\n// replace: function (HTMLElement) => HTMLElement\n\nclass Replace extends Rule {\n  constructor(options) {\n    super(options);\n    this.name = 'Replace';\n  }\n  afterAdd(element, book, continueOnNewPage, makeNewPage, overflowCallback) {\n    const parent = element.parentNode;\n    if (!parent) {\n      console.error(element);\n      throw Error(`Bindery.Replace({ selector: '${this.selector}' }).afterAdd called on element that hasn't been added.`);\n    }\n    const defensiveClone = element.cloneNode(true);\n    const replacement = this.createReplacement(book, defensiveClone);\n    parent.replaceChild(replacement, element);\n\n    if (book.currentPage.hasOverflowed()) {\n      parent.replaceChild(element, replacement);\n\n      return overflowCallback(element);\n    }\n\n    return replacement;\n  }\n  createReplacement(book, element) {\n    return this.replace(element);\n  }\n  replace(element) {\n    element.insertAdjacentHTML('beforeEnd', '<sup class=\"bindery-sup\">Default Replacement</sup>');\n    return element;\n  }\n}\n\nexport default Replace;\n","import Replace from './Replace';\nimport { validate, T } from '../option-checker';\nimport { createEl } from '../dom-utils';\n\n// Options:\n// selector: String\n// replace: function (HTMLElement, number) => HTMLElement\n// render: function (Page) => HTMLElement\n\nclass Footnote extends Replace {\n  constructor(options) {\n    super(options);\n    validate(options, {\n      name: 'Footnote',\n      selector: T.string,\n      replace: T.func,\n      render: T.func,\n    });\n  }\n  afterAdd(element, book, continueOnNewPage, makeNewPage, overflowCallback) {\n    const number = book.currentPage.footer.children.length + 1;\n\n    const footnote = createEl('.footnote');\n    const contents = this.render(element, number);\n    if (contents instanceof HTMLElement) footnote.appendChild(contents);\n    else footnote.innerHTML = contents;\n\n    book.currentPage.footer.appendChild(footnote);\n\n    return super.afterAdd(element, book, continueOnNewPage, makeNewPage, (overflowEl) => {\n      book.currentPage.footer.removeChild(footnote);\n      return overflowCallback(overflowEl);\n    });\n  }\n  createReplacement(book, element) {\n    const number = book.currentPage.footer.children.length;\n    return this.replace(element, number);\n  }\n  replace(element, number) {\n    element.insertAdjacentHTML('beforeEnd', `<sup class=\"bindery-sup\">${number}</sup>`);\n    return element;\n  }\n  render(element, number) {\n    return `<sup>${number}</sup> Default footnote (<a href='/bindery/docs/#footnote'>Learn how to change it</a>)`;\n  }\n}\n\nexport default Footnote;\n","const pageNumbersForTest = (pages, test) =>\n  pages.filter(pg => pg.number && test(pg.element)).map(pg => pg.number);\n\nconst pageNumbersForSelector = (pages, sel) =>\n  pageNumbersForTest(pages, el => el.querySelector(sel));\n\nconst formatAsRanges = (pageNumbers) => {\n  let str = '';\n  let prevNum = pageNumbers[0];\n  let isInARange = false;\n\n  const addFirst = (num) => {\n    str += `${num}`;\n  };\n  const continueRange = () => {\n    isInARange = true;\n  };\n  const endRange = (endNum) => {\n    isInARange = false;\n    str += `â€“${endNum}`;\n  };\n  const addComma = (num) => {\n    str += `, ${num}`;\n  };\n  const endAndAdd = (endNum, num) => {\n    endRange(endNum);\n    addComma(num);\n  };\n  const addLast = (num, isAdjacent) => {\n    if (isAdjacent) endRange(num);\n    else if (isInARange && !isAdjacent) endAndAdd(prevNum, num);\n    else addComma(num);\n  };\n\n  pageNumbers.forEach((num, i) => {\n    const isLast = i === pageNumbers.length - 1;\n    const isAdjacent = num === prevNum + 1;\n\n    if (i === 0) addFirst(num);\n    else if (isLast) addLast(num, isAdjacent);\n    else if (isAdjacent) continueRange();\n    else if (isInARange && !isAdjacent) endAndAdd(prevNum, num);\n    else addComma(num);\n    prevNum = num;\n  });\n  return str;\n};\n\nexport { pageNumbersForTest, pageNumbersForSelector, formatAsRanges };\n","// https://github.com/moroshko/shallow-equal/blob/master/src/arrays.js\nconst shallowEqual = (a, b) => {\n  if (a === b) return true;\n  if (!a || !b) return false;\n\n  const len = a.length;\n\n  if (b.length !== len) {\n    return false;\n  }\n\n  for (let i = 0; i < len; i += 1) {\n    if (a[i] !== b[i]) return false;\n  }\n\n  return true;\n};\n\nexport default shallowEqual;\n","const throttleFrame = () => {\n  let wasCalled = false;\n  let queued;\n  const inner = (func) => {\n    if (wasCalled) {\n      queued = func;\n      return;\n    }\n    wasCalled = true;\n    func();\n    requestAnimationFrame(() => {\n      wasCalled = false;\n      if (queued) {\n        const queuedFunc = queued;\n        queued = null;\n        inner(queuedFunc);\n      }\n    });\n  };\n  return inner;\n};\n\nconst throttleTime = (time) => {\n  let wasCalled = false;\n  let queued;\n  const inner = (func) => {\n    if (wasCalled) {\n      queued = func;\n      return;\n    }\n    wasCalled = true;\n    func();\n    setTimeout(() => {\n      wasCalled = false;\n      if (queued) {\n        const queuedFunc = queued;\n        queued = null;\n        inner(queuedFunc);\n      }\n    }, time);\n  };\n  return inner;\n};\n\n\nexport { throttleFrame, throttleTime };\n","import Replace from './Replace';\nimport { pageNumbersForTest, formatAsRanges } from './searchPages';\n\nimport { shallowEqual, throttleTime } from '../utils';\nimport { validate, T } from '../option-checker';\nimport { c } from '../dom-utils';\n\n// Compatible with ids that start with numbers\nconst startsNum = sel => sel.length > 2 && sel[0] === '#' && /^\\d+$/.test(sel[1]);\nconst safeIDSel = sel => (startsNum(sel) ? `[id=\"${sel.replace('#', '')}\"]` : sel);\n\n// Options:\n// selector: String\n// replace: function (HTMLElement, number) => HTMLElement\nclass PageReference extends Replace {\n  constructor(options) {\n    super(options);\n    validate(options, {\n      name: 'PageReference',\n      selector: T.string,\n      replace: T.func,\n      createTest: T.func,\n    });\n    this.references = [];\n    const throttle = throttleTime(10);\n    this.throttledUpdate = (book) => {\n      throttle(() => this.updatePageReferences(book.pages));\n    };\n  }\n\n  eachPage(page, book) {\n    this.throttledUpdate(book);\n  }\n\n  afterAdd(elmt, book) {\n    const test = this.createTest(elmt);\n    if (!test) return elmt;\n\n    const ref = this.createReference(book, test, elmt);\n    return ref.element;\n  }\n\n  createReference(book, test, elmt) {\n    const ref = { test, template: elmt, element: elmt, value: null };\n    const render = newValue => this.render(ref, newValue);\n    ref.render = render;\n    this.references.push(ref);\n    const currentResults = pageNumbersForTest(book.pages, test);\n\n    ref.render(currentResults); // Replace element immediately, to make sure it'll fit\n    return ref;\n  }\n\n  render(ref, newValue) {\n    if (!newValue || shallowEqual(ref.value, newValue)) return;\n    if (!Array.isArray(newValue)) throw Error('Page search returned unexpected result');\n\n    const isResolved = newValue.length > 0;\n    const pageRanges = isResolved ? formatAsRanges(newValue) : 'âŒ§';\n\n    const template = ref.template.cloneNode(true);\n    const newRender = this.replace(template, pageRanges);\n    if (!isResolved) newRender.classList.add(c('placeholder-num'));\n    ref.element.parentNode.replaceChild(newRender, ref.element);\n\n    ref.element = newRender;\n    ref.value = newValue;\n  }\n\n  createTest(element) {\n    const href = element.getAttribute('href');\n    if (!href) return null;\n    const selector = safeIDSel(href);\n    return el => el.querySelector(selector);\n  }\n\n  updatePageReferences(pages) {\n    // querySelector first, then rerender\n    const results = this.references.map(ref =>\n      ({ ref, data: pageNumbersForTest(pages, ref.test) }));\n    results.forEach(({ ref, data }) => this.render(ref, data));\n  }\n\n  replace(template, number) {\n    template.insertAdjacentHTML('beforeend', `, <span>${number}</span>`);\n    return template;\n  }\n}\n\nexport default PageReference;\n","import Rule from './Rule';\nimport { validate, T } from '../option-checker';\n\nclass PageBreak extends Rule {\n  constructor(options) {\n    options.position = options.position || 'before';\n    options.continue = options.continue || 'next';\n    super(options);\n\n    validate(options, {\n      name: 'PageBreak',\n      selector: T.string,\n      continue: T.enum('next', 'left', 'right'),\n      position: T.enum('before', 'after', 'both', 'avoid'),\n    });\n  }\n  get avoidSplit() {\n    return this.position === 'avoid';\n  }\n  beforeAdd(elmt, book, continueOnNewPage) {\n    if (this.position === 'before' || this.position === 'both') {\n      if (!book.currentPage.isEmpty) {\n        continueOnNewPage();\n      }\n      if (this.continue !== 'next') {\n        book.currentPage.setPreference(this.continue);\n      }\n    }\n    return elmt;\n  }\n  afterAdd(elmt, book, continueOnNewPage) {\n    if (this.position === 'after' || this.position === 'both') {\n      const newPage = continueOnNewPage(true);\n      if (this.continue !== 'next') {\n        newPage.setPreference(this.continue);\n      }\n    }\n    return elmt;\n  }\n}\n\nexport default PageBreak;\n","import Rule from './Rule';\nimport { validate, T } from '../option-checker';\nimport { createEl } from '../dom-utils';\n\n// Options:\n// selector: String\n// render: function (Page) => HTMLElement\n// TODO selectorHierarchy: [ String ], ie [ 'h1', 'h2', 'h3.chapter' ]\n\nclass RunningHeader extends Rule {\n  constructor(options = {}) {\n    super(options);\n    validate(options, {\n      name: 'RunningHeader',\n      render: T.func,\n    });\n  }\n  eachPage(page) {\n    if (!page.runningHeader) {\n      const elmt = createEl('.running-header');\n      page.element.appendChild(elmt);\n      page.runningHeader = elmt;\n    }\n    page.runningHeader.innerHTML = this.render(page);\n  }\n  render(page) {\n    return page.number;\n  }\n}\n\nexport default RunningHeader;\n","import Rule from './Rule';\nimport { validate, T } from '../option-checker';\n\nclass Split extends Rule {\n  constructor(options) {\n    super(options);\n\n    validate(options, {\n      name: 'Split',\n      selector: T.string,\n      toNext: T.string,\n      fromPrevious: T.string,\n      didSplit: T.func,\n    });\n  }\n\n  didSplit(original, clone) {\n    if (this.toNext) original.classList.add(this.toNext);\n    if (this.fromPrevious) clone.classList.add(this.fromPrevious);\n  }\n}\n\nexport default Split;\n","import Counter from './Counter';\nimport FullBleedSpread from './FullBleedSpread';\nimport FullBleedPage from './FullBleedPage';\nimport Footnote from './Footnote';\nimport PageReference from './PageReference';\nimport PageBreak from './PageBreak';\nimport RunningHeader from './RunningHeader';\nimport Replace from './Replace';\nimport Rule from './Rule';\nimport Split from './Split';\n\nexport default {\n  Rule,\n  Split(options) {\n    return new Split(options);\n  },\n  Counter(options) {\n    return new Counter(options);\n  },\n  FullBleedPage(options) {\n    return new FullBleedPage(options);\n  },\n  Footnote(options) {\n    return new Footnote(options);\n  },\n  RunningHeader(options) {\n    return new RunningHeader(options);\n  },\n  Replace(options) {\n    return new Replace(options);\n  },\n  FullBleedSpread(options) {\n    return new FullBleedSpread(options);\n  },\n  PageBreak(options) {\n    return new PageBreak(options);\n  },\n  PageReference(options) {\n    return new PageReference(options);\n  },\n  createRule(options) {\n    return new Rule(options);\n  },\n};\n","import rules from '../rules';\n\nconst {\n  PageBreak,\n  PageReference,\n  Footnote,\n  FullBleedPage,\n  FullBleedSpread,\n} = rules;\n\nconst replacer = (element, number) => {\n  element.textContent = `${number}`;\n  return element;\n};\n\nexport default [\n  PageBreak({ selector: '[book-page-break=\"both\"]', position: 'both' }),\n  PageBreak({ selector: '[book-page-break=\"avoid\"]', position: 'avoid' }),\n\n  PageBreak({ selector: '[book-page-break=\"after\"][book-page-continue=\"right\"]', position: 'after', continue: 'right' }),\n  PageBreak({ selector: '[book-page-break=\"after\"][book-page-continue=\"left\"]', position: 'after', continue: 'left' }),\n  PageBreak({ selector: '[book-page-break=\"after\"][book-page-continue=\"next\"]', position: 'after', continue: 'next' }),\n\n  PageBreak({ selector: '[book-page-break=\"before\"][book-page-continue=\"right\"]', position: 'before', continue: 'right' }),\n  PageBreak({ selector: '[book-page-break=\"before\"][book-page-continue=\"left\"]', position: 'before', continue: 'left' }),\n  PageBreak({ selector: '[book-page-break=\"before\"][book-page-continue=\"next\"]', position: 'before', continue: 'next' }),\n\n  FullBleedPage({ selector: '[book-full-bleed=\"page\"]' }),\n  FullBleedSpread({ selector: '[book-full-bleed=\"spread\"]' }),\n\n  Footnote({\n    selector: '[book-footnote-text]',\n    render: (element, number) => {\n      const txt = element.getAttribute('book-footnote-text');\n      return `<i>${number}</i>${txt}`;\n    },\n  }),\n\n  PageReference({\n    selector: '[book-pages-with-text]',\n    replace: replacer,\n    createTest: (element) => {\n      const term = element.getAttribute('book-pages-with-text').toLowerCase().trim();\n      return page => page.textContent.toLowerCase().includes(term);\n    },\n  }),\n\n  PageReference({\n    selector: '[book-pages-with-selector]',\n    replace: replacer,\n    createTest: (element) => {\n      const sel = element.getAttribute('book-pages-with-selector').trim();\n      return page => page.querySelector(sel);\n    },\n  }),\n\n  PageReference({\n    selector: '[book-pages-with]',\n    replace: replacer,\n    createTest: (element) => {\n      const term = element.textContent.toLowerCase().trim();\n      return (page) => {\n        const txt = page.textContent.toLowerCase();\n        return txt.includes(term);\n      };\n    },\n  }),\n];\n","/* ðŸ“– Regionize v0.1.3 */\nconst div = (cls) => {\n  const el = document.createElement('div');\n  el.classList.add(cls);\n  return el;\n};\n\nclass Region {\n  constructor(elmt) {\n    this.element = elmt;\n    this.content = div('region-content');\n    this.content.style.padding = '0.1px';\n    this.content.style.position = 'relative';\n    this.element.appendChild(this.content);\n    this.path = [];\n  }\n\n  setPath(newPath) {\n    this.path = newPath;\n    if (newPath.length > 0) this.content.appendChild(newPath[0]);\n  }\n\n  get currentElement() {\n    const len = this.path.length;\n    if (len > 0) return this.path[len - 1];\n    return this.content;\n  }\n\n  get isEmpty() {\n    return this.content.textContent.trim() === '' && this.content.offsetHeight < 1;\n  }\n\n  get isReasonableSize() {\n    const box = this.element.getBoundingClientRect();\n    return (box.height > 100) && (box.width > 100); // TODO: Number is arbitrary\n  }\n\n  overflowAmount() {\n    const contentH = this.content.offsetHeight;\n    const boxH = this.element.offsetHeight;\n    if (boxH === 0) throw Error('Regionizer: Trying to flow into an element with zero height.');\n    return contentH - boxH;\n  }\n\n  hasOverflowed() {\n    return this.overflowAmount() > -5;\n  }\n}\n\nconst isTextNode = node => node.nodeType === Node.TEXT_NODE;\nconst isElement = node => node.nodeType === Node.ELEMENT_NODE;\nconst isScript = node => node.tagName === 'SCRIPT';\nconst isImage = node => node.tagName === 'IMG';\nconst isUnloadedImage = node => isImage(node) && !node.naturalWidth;\nconst isContentElement = node => isElement(node) && !isScript(node);\n\nconst MAX_TIME = 30; // ms\n\nconst rAF = () => new Promise((resolve) => {\n  requestAnimationFrame(t => resolve(t));\n});\n\nlet lastYieldTime = 0;\n\nconst shouldYield = () => {\n  const timeSinceYield = performance.now() - lastYieldTime;\n  return timeSinceYield > MAX_TIME;\n};\n\nconst yieldIfNecessary = async () => {\n  if (shouldYield()) lastYieldTime = await rAF();\n};\n\nconst overflowAttr = 'data-ignore-overflow';\n// Walk up the tree to see if we are within\n// an overflow-ignoring node\nconst ignoreOverflow = (element) => {\n  if (element.hasAttribute(overflowAttr)) return true;\n  if (element.parentElement) return ignoreOverflow(element.parentElement);\n  return false;\n};\n\nconst createTextNode = (document.createTextNode).bind(document);\n\n// Try adding a text node in one go.\n// Returns true if all the text fits, false if none fits.\nconst addTextNode = async (textNode, parent, hasOverflowed) => {\n  parent.appendChild(textNode);\n  const success = !hasOverflowed();\n  if (!success) parent.removeChild(textNode);\n  await yieldIfNecessary();\n  return success;\n};\n\n\n// Try adding a text node by incrementally adding words\n// until it just barely doesnt overflow.\n//\n// Returns true if all the text fits, false if none fits,\n// or new textnode containing the remainder text.\nconst addTextNodeUntilOverflow = async (textNode, parent, hasOverflowed) => {\n  const originalText = textNode.nodeValue;\n  parent.appendChild(textNode);\n\n  if (!hasOverflowed() || ignoreOverflow(parent)) {\n    return true;\n  }\n\n  // Add letter by letter until overflow\n  let pos = 0;\n  textNode.nodeValue = originalText.substr(0, pos);\n\n  while (!hasOverflowed() && pos < originalText.length) {\n    // advance to next non-space character\n    pos += 1;\n    while (pos < originalText.length && originalText.charAt(pos) !== ' ') pos += 1;\n\n    if (pos < originalText.length) {\n      // reveal more text\n      textNode.nodeValue = originalText.substr(0, pos);\n      await yieldIfNecessary();\n    }\n  }\n\n  // Back out to word boundary\n  if (originalText.charAt(pos) === ' ') pos -= 1; // TODO: redundant\n  while (originalText.charAt(pos) !== ' ' && pos > 0) pos -= 1;\n\n  if (pos < 1) {\n    // We didn't even add a complete word, don't add node\n    textNode.nodeValue = originalText;\n    parent.removeChild(textNode);\n    return false; // TODO\n  }\n\n  // trim text to word\n  const fittingText = originalText.substr(0, pos);\n  const overflowingText = originalText.substr(pos);\n  textNode.nodeValue = fittingText;\n\n  // Create a new text node for the next flow box\n  const remainingTextNode = createTextNode(overflowingText);\n  return remainingTextNode;\n};\n\n\n// Fills text across multiple elements by requesting a continuation\n// once the current element overflows\nconst addTextNodeAcrossParents = async (textNode, parent, nextParent, hasOverflowed) => {\n  const result = await addTextNodeUntilOverflow(textNode, parent, hasOverflowed);\n  if (isTextNode(result)) {\n    const nextElement = nextParent();\n    return addTextNodeAcrossParents(result, nextElement, nextParent, hasOverflowed);\n  }\n  return result;\n};\n\n// Shifts this element to the next page. If any of its\n// ancestors cannot be split across page, it will\n// step up the tree to find the first ancestor\n// that can be split, and move all of that descendants\n// to the next page.\nconst tryInNextRegion = (region, makeNextRegion, canSplit) => {\n  if (region.path.length <= 1) {\n    throw Error('Regionize: Attempting to move the top-level element');\n  }\n  const startLength = region.path.length;\n\n  // So this node won't get cloned. TODO: this is unclear\n  const elementToMove = region.path.pop();\n\n  // find the nearest splittable parent\n  let nearestElementThatCanBeMoved = elementToMove;\n  const pathToRestore = [];\n  while (region.path.length > 1 && !canSplit(region.currentElement)) {\n    nearestElementThatCanBeMoved = region.path.pop();\n    pathToRestore.unshift(nearestElementThatCanBeMoved);\n  }\n\n  // Once a node is moved to a new page, it should no longer trigger another\n  // move. otherwise tall elements will endlessly get shifted to the next page\n  nearestElementThatCanBeMoved.setAttribute('data-bindery-did-move', true);\n\n  const parent = nearestElementThatCanBeMoved.parentNode;\n  parent.removeChild(nearestElementThatCanBeMoved);\n\n  // If the nearest ancestor would be empty without this node,\n  // move it to the next page too.\n  if (region.path.length > 1 && region.currentElement.textContent.trim() === '') {\n    parent.appendChild(nearestElementThatCanBeMoved);\n    nearestElementThatCanBeMoved = region.path.pop();\n    pathToRestore.unshift(nearestElementThatCanBeMoved);\n    nearestElementThatCanBeMoved.parentNode.removeChild(nearestElementThatCanBeMoved);\n  }\n\n  let nextRegion;\n  if (!region.isEmpty) {\n    if (region.hasOverflowed()) {\n      // Recovery failed, maybe the box contains a large\n      // unsplittable element.\n      region.suppressErrors = true;\n    }\n    nextRegion = makeNextRegion();\n  } else {\n    // If the page is empty when this node is removed,\n    // then it won't help to move it to the next page.\n    // Instead continue here until the node is done.\n    nextRegion = region;\n  }\n\n  // append moved node as first in new page\n  nextRegion.currentElement.appendChild(nearestElementThatCanBeMoved);\n\n  // restore subpath\n  pathToRestore.forEach(r => nextRegion.path.push(r));\n  nextRegion.path.push(elementToMove);\n\n  if (startLength !== nextRegion.path.length) {\n    throw Error('Regionize: Restored path depth does not match original path depth');\n  }\n};\n\n// The path is an array of nested elments,\n// for example .content > article > p > a).\n//\n// It's shallowly cloned every time we move to the next page,\n// to create the illusion that nodes are continuing from page\n// to page.\n//\n// The transition can be customized by setting a Split rule,\n// which lets you add classes to the original and cloned element\n// to customize styling.\n\nconst clonePath = (oldPath, applyRules) => {\n  const newPath = [];\n\n  const deepClone = (el) => {\n    const clone = el.cloneNode(true); // deep clone, could be th > h3 > span;\n    applyRules(el, clone);\n    return clone;\n  };\n\n  for (let i = oldPath.length - 1; i >= 0; i -= 1) {\n    const original = oldPath[i];\n    const clone = original.cloneNode(false); // shallow\n    const nextChild = oldPath[i + 1];\n    clone.innerHTML = '';\n\n    applyRules(original, clone, nextChild, deepClone);\n\n    if (i < oldPath.length - 1) clone.appendChild(newPath[i + 1]);\n    newPath[i] = clone;\n  }\n\n  return newPath;\n};\n\n// Polls every 10ms for image.naturalWidth\n// or an error event.\n//\n// Note: Doesn't ever reject, since missing images\n// shouldn't prevent layout from resolving\n\nconst wait10 = () => new Promise((resolve) => {\n  setTimeout(() => { resolve(); }, 10);\n});\n\nconst ensureImageLoaded = async (image) => {\n  const imgStart = performance.now();\n  let failed = false;\n  image.addEventListener('error', () => { failed = true; });\n  image.src = image.src; // re-trigger error if already failed\n\n  while (!image.naturalWidth && !failed) {\n    await wait10();\n  }\n\n  return performance.now() - imgStart;\n};\n\nconst preserveNumbering = (original, clone, nextChild) => {\n  // restart numbering\n  let prevStart = 1;\n  if (original.hasAttribute('start')) {\n    // the OL is also a continuation\n    prevStart = parseInt(original.getAttribute('start'), 10);\n  }\n  if (nextChild && nextChild.tagName === 'LI') {\n    // the first list item is a continuation\n    prevStart -= 1;\n  }\n  const prevCount = original.children.length;\n  const newStart = prevStart + prevCount;\n  clone.setAttribute('start', newStart);\n};\n\nconst preserveTableColumns = (original, clone, nextChild, deepClone) => {\n  const columns = [...original.children];\n\n  const currentIndex = columns.indexOf(nextChild);\n  for (let i = 0; i < currentIndex; i += 1) {\n    const clonedCol = deepClone(columns[i]);\n    clone.appendChild(clonedCol);\n  }\n};\n\nconst noop = () => {};\nconst always = () => true;\nconst never = () => false;\n\n// flow content through FlowBoxes.\n// This function is not book-specific,\n// the caller is responsible for managing\n// and creating boxes.\nconst flowIntoRegions = async (opts) => {\n  // required options\n  const content = opts.content;\n  const createRegion = opts.createRegion;\n  if (!content) throw Error('content not specified');\n  if (!createRegion) throw Error('createRegion not specified');\n\n  // optional\n  const applySplit = opts.applySplit || noop;\n  const canSplit = opts.canSplit || always;\n  const beforeAdd = opts.beforeAdd || noop;\n  const afterAdd = opts.afterAdd || noop;\n  const didWaitFor = opts.didWaitFor || noop;\n  const shouldTraverse = opts.shouldTraverse || never;\n\n  // ____\n  // Begin\n  let currentRegion = createRegion();\n  const hasOverflowed = () => currentRegion.hasOverflowed();\n  const canSplitCurrent = () => canSplit(currentRegion.currentElement);\n  const ignoreCurrentOverflow = () => ignoreOverflow(currentRegion.currentElement);\n\n  const splitRules = (prev, clone, next, deepClone) => {\n    if (prev.tagName === 'OL') preserveNumbering(prev, clone, next, deepClone);\n    if (prev.tagName === 'TR') preserveTableColumns(prev, clone, next, deepClone);\n    applySplit(prev, clone, next, deepClone);\n  };\n\n  const continueInNextRegion = () => {\n    const oldBox = currentRegion;\n    currentRegion = createRegion();\n\n    const newPath = clonePath(oldBox.path, splitRules);\n    currentRegion.setPath(newPath);\n    return currentRegion;\n  };\n\n  const continuedParent = () => {\n    continueInNextRegion();\n    return currentRegion.currentElement;\n  };\n\n  const addTextWithoutChecks = (textNode, parent) => {\n    parent.appendChild(textNode);\n    if (!ignoreCurrentOverflow() && canSplitCurrent()) {\n      currentRegion.suppressErrors = true;\n      continueInNextRegion();\n    }\n  };\n\n  const addSplittableTextNode = async (textNode) => {\n    const el = currentRegion.currentElement;\n    let hasAdded = await addTextNodeAcrossParents(textNode, el, continuedParent, hasOverflowed);\n    if (!hasAdded && currentRegion.path.length > 1) {\n      // retry 1\n      tryInNextRegion(currentRegion, continueInNextRegion, canSplit);\n      hasAdded = await addTextNodeAcrossParents(textNode, el, continuedParent, hasOverflowed);\n    }\n    if (!hasAdded) {\n      // retry 2\n      addTextWithoutChecks(textNode, currentRegion.currentElement);\n    }\n  };\n\n  const addWholeTextNode = async (textNode) => {\n    let hasAdded = await addTextNode(textNode, currentRegion.currentElement, hasOverflowed);\n    if (!hasAdded && !ignoreCurrentOverflow()) {\n      // retry 1\n      tryInNextRegion(currentRegion, continueInNextRegion, canSplit);\n      hasAdded = await addTextNode(textNode, currentRegion.currentElement, hasOverflowed);\n    }\n    if (!hasAdded) {\n      // retry 2\n      addTextWithoutChecks(textNode, currentRegion.currentElement);\n    }\n  };\n\n  // No need to traverse every node if fifts AND\n  // none of the contents could change size.\n  // Images and custom rules could cause the size to change\n  const canSkipTraversal = (element) => {\n    const containsImage = element.querySelector('img');\n    return !containsImage && !shouldTraverse(element);\n  };\n\n  let safeAddElementNode;\n\n  // Adds an element node by clearing its childNodes, then inserting them\n  // one by one recursively until they overflow the region\n  const addElementNode = async (element) => {\n    // Insert element\n    currentRegion.currentElement.appendChild(element);\n    currentRegion.path.push(element);\n\n    if (canSkipTraversal(element)) {\n      // console.log('maybe short circuit');\n      if (!hasOverflowed()) {\n        // console.log('did short circuit');\n        return currentRegion.path.pop();\n      }\n    }\n\n    // Clear element\n    const childNodes = [...element.childNodes];\n    element.innerHTML = '';\n\n    // Overflows when empty\n    if (hasOverflowed() && !ignoreCurrentOverflow() && canSplitCurrent()) {\n      tryInNextRegion(currentRegion, continueInNextRegion, canSplit);\n    }\n\n    const shouldSplit = canSplit(element) && !ignoreOverflow(element);\n\n    for (const child of childNodes) {\n      if (isTextNode(child)) {\n        await (shouldSplit ? addSplittableTextNode : addWholeTextNode)(child);\n      } else if (isContentElement(child)) {\n        await safeAddElementNode(child);\n      }\n    }\n    return currentRegion.path.pop();\n  };\n\n  safeAddElementNode = async (element) => {\n    // Ensure images are loaded before measuring\n    if (isUnloadedImage(element)) {\n      const waitTime = await ensureImageLoaded(element);\n      didWaitFor(waitTime);\n    }\n\n    // Transforms before adding\n    beforeAdd(element, continueInNextRegion);\n\n    const addedElement = await addElementNode(element);\n\n    // Transforms after adding\n    afterAdd(addedElement, continueInNextRegion);\n  };\n\n  return safeAddElementNode(content);\n};\n\nexport { Region, flowIntoRegions };\n","import { Region } from 'regionize';\nimport { safeMeasure, createEl, classes } from '../dom-utils';\n\nclass Page {\n  constructor() {\n    this.flow = new Region(createEl('flow-box'));\n    this.footer = createEl('footer');\n    this.background = createEl('page-background');\n    this.element = createEl('page', [this.background, this.flow.element, this.footer]);\n  }\n\n  static isSizeValid() {\n    const testPage = new Page();\n    return safeMeasure(testPage.element, () => testPage.flow.isReasonableSize);\n  }\n\n  setLeftRight(dir) {\n    this.side = dir;\n    this.element.classList.toggle(classes.leftPage, this.isLeft);\n    this.element.classList.toggle(classes.rightPage, !this.isLeft);\n  }\n  get isLeft() {\n    return this.side === 'left';\n  }\n\n  get isRight() {\n    return this.side === 'right';\n  }\n\n  setPreference(dir) {\n    const preferLeft = dir === 'left';\n    this.alwaysLeft = preferLeft;\n    this.alwaysRight = !preferLeft;\n  }\n\n  get suppressErrors() {\n    return this.suppress || false;\n  }\n\n  set suppressErrors(newVal) {\n    this.suppress = newVal;\n    this.element.classList.toggle(classes.isOverflowing, newVal);\n  }\n\n  get isEmpty() {\n    return !this.hasOutOfFlowContent && this.flow.isEmpty;\n  }\n\n  validate() {\n    if (!this.hasOverflowed()) return;\n    const suspect = this.currentElement;\n    if (suspect) {\n      console.warn('Bindery: Content overflows, probably due to a style set on:', suspect);\n      suspect.parentNode.removeChild(suspect);\n    } else {\n      console.warn('Bindery: Content overflows.');\n    }\n  }\n\n  validateEnd(allowOverflow) {\n    if (!this.hasOverflowed()) return;\n    console.warn(`Bindery: Page ~${this.number} is overflowing`, this.element);\n    if (!this.suppressErrors && !this.flow.suppressErrors && !allowOverflow) {\n      throw Error('Bindery: Moved to new page when last one is still overflowing');\n    }\n  }\n\n  hasOverflowed() {\n    return safeMeasure(this.element, () => this.flow.hasOverflowed());\n  }\n}\n\nexport default Page;\n","const indexOfNextReorderablePage = (pages, startIndex) => {\n  for (let i = startIndex; i < pages.length; i += 1) {\n    const pg = pages[i];\n    if (!pg.isOutOfFlow && !pg.avoidReorder) return i;\n  }\n  return null;\n};\n\n// Given an array of pages with alwaysLeft, alwaysRight, and isOutOfFlow\n// properties, orders them so that alwaysLeft and alwaysRight are true.\n\nconst orderPages = (pages, makeNewPage) => {\n  const orderedPages = pages.slice();\n\n  for (let i = 0; i < orderedPages.length; i += 1) {\n    const page = orderedPages[i];\n    const isLeft = i % 2 !== 0;\n\n    if ((isLeft && page.alwaysRight) || (!isLeft && page.alwaysLeft)) {\n      if (page.isOutOfFlow) {\n        // If the page is 'out of flow', we'd prefer not to add a blank page.\n        // Instead it floats backwards in the book, pulling the next\n        // in-flow page forward. If several 'out of flow' pages\n        // are next to each other, they will remain in order, all being pushed\n        // backward together.\n\n        const indexToSwap = indexOfNextReorderablePage(orderedPages, i + 1);\n        if (!indexToSwap) {\n          // No larger index to swap with, perhaps because\n          // we are optimistically rendering before the book is done\n          break;\n        }\n        const pageToMoveUp = orderedPages[indexToSwap];\n        orderedPages.splice(indexToSwap, 1); // remove pg\n        orderedPages.splice(i, 0, pageToMoveUp); // insert pg\n      } else {\n        // If the page is 'in flow', order must be respected, so extra blank pages\n        // are inserted.\n        orderedPages.splice(i, 0, makeNewPage());\n      }\n    }\n  }\n  return orderedPages;\n};\n\nexport default orderPages;\n","import Page from './Page';\nimport orderPages from './orderPages';\n\nconst MAXIMUM_PAGE_LIMIT = 2000;\n\nclass Book {\n  constructor() {\n    this.rawPages = [];\n    this.orderedPages = [];\n  }\n\n  addPage(newPage) {\n    this.rawPages.push(newPage);\n    this.updatePageOrder();\n  }\n\n  get pageCount() {\n    return this.orderedPages.length;\n  }\n\n  get pages() {\n    return this.orderedPages;\n  }\n\n  updatePageOrder() {\n    this.orderedPages = orderPages(this.rawPages, () => new Page());\n  }\n\n  validate() {\n    if (this.pageCount > MAXIMUM_PAGE_LIMIT) {\n      throw Error('Bindery: Maximum page count exceeded. Suspected runaway layout.');\n    }\n  }\n}\n\nexport default Book;\n","const annotatePages = (pages, offset) => {\n  // â€”â€”â€”\n  // NUMBERING\n\n  // TODO: Pass in facingpages options\n  const facingPages = true;\n  if (facingPages) {\n    pages.forEach((page, i) => {\n      page.number = offset + i + 1;\n      page.setLeftRight((i % 2 === 0) ? 'right' : 'left');\n    });\n  } else {\n    pages.forEach((page) => { page.setLeftRight('right'); });\n  }\n\n  // â€”â€”â€”\n  // RUNNING HEADERS\n\n  // Sections to annotate with.\n  // This should be a hierarchical list of selectors.\n  // Every time one is selected, it annotates all following pages\n  // and clears any subselectors.\n  // TODO: Make this configurable\n  const running = { h1: '', h2: '', h3: '', h4: '', h5: '', h6: '' };\n\n  pages.forEach((page) => {\n    page.heading = {};\n    Object.keys(running).forEach((tagName, i) => {\n      const element = page.element.querySelector(tagName);\n      if (element) {\n        running[tagName] = element.textContent;\n        // clear remainder\n        Object.keys(running).forEach((tag, j) => {\n          if (j > i) running[tag] = '';\n        });\n      }\n      if (running[tagName] !== '') {\n        page.heading[tagName] = running[tagName];\n      }\n    });\n  });\n};\n\nexport default annotatePages;\n","import FullBleedPage from '../rules/FullBleedPage';\nimport FullBleedSpread from '../rules/FullBleedSpread';\nimport PageBreak from '../rules/PageBreak';\n\nconst isSpread = rule => rule instanceof FullBleedSpread;\nconst isPage = rule => rule instanceof FullBleedPage;\nconst isBreak = rule => rule instanceof PageBreak;\n\nconst isFullPageRule = rule => isSpread(rule) || isPage(rule) || isBreak(rule);\n\nconst dedupe = (inputRules) => {\n  const conflictRules = inputRules.filter(isFullPageRule);\n  const output = inputRules.filter(rule => !conflictRules.includes(rule));\n\n  const firstSpreadRule = conflictRules.find(isSpread);\n  const firstPageRule = conflictRules.find(isPage);\n\n  // Only apply one fullpage or fullspread\n  if (firstSpreadRule) output.push(firstSpreadRule);\n  else if (firstPageRule) output.push(firstPageRule);\n  else output.push(...conflictRules); // but multiple pagebreaks are ok\n\n  return output;\n};\n\nexport default dedupe;\n","// TODO:\n// While this does catch overflows, it is pretty hacky to move the entire node to the next page.\n// - 1. there is no guarentee it will fit on the new page\n// - 2. if it had childNodes, those side effects will not be undone,\n// which means footnotes will get left on previous page.\n// - 3. if it is a large paragraph, it will leave a large gap. the\n// ideal approach would be to only need to invalidate the last line of text.\nconst recoverFromRule = (el, book, nextBox) => {\n  let removed = el;\n  const parent = el.parentNode;\n  parent.removeChild(removed);\n  let popped;\n  if (book.currentPage.hasOverflowed()) {\n    parent.appendChild(el);\n    removed = parent;\n    removed.parentNode.removeChild(removed);\n    popped = book.currentPage.flow.path.pop();\n    if (book.currentPage.hasOverflowed()) {\n      console.error('Trying again didnt fix it');\n    } else {\n      // Trying again worked\n    }\n  }\n  const newBox = nextBox();\n  newBox.currentElement.appendChild(removed);\n  if (popped) newBox.path.push(popped);\n};\n\n\nexport default recoverFromRule;\n","import { classes } from '../dom-utils';\nimport dedupe from './dedupeRules';\nimport recoverFromRule from './recoverFromRule';\n\nconst giveUp = (rule, el) => {\n  console.warn(`Couldn't apply ${rule.name}, caused overflows twice when adding: `, el);\n};\n\nclass RuleSet {\n  constructor(rules) {\n    const offsetRule = rules.find(r => r.pageNumberOffset);\n    this.pageNumberOffset = offsetRule ? offsetRule.pageNumberOffset : 0;\n\n    // Rules for pages\n    this.pageRules = rules.filter(r => r.eachPage);\n\n    // Rules for elements\n    this.beforeAddRules = rules.filter(r => r.selector && r.beforeAdd);\n    this.afterAddRules = rules.filter(r => r.selector && r.afterAdd);\n\n    // Rules for layout\n    this.selectorsNotToSplit = rules.filter(r => r.avoidSplit).map(r => r.selector);\n    this.didSplitRules = rules.filter(r => r.selector && r.didSplit);\n\n    // setup\n    rules.filter(r => r.setup).forEach(r => r.setup());\n\n    this.applySplitRules = this.applySplitRules.bind(this);\n\n    const allSelectors = rules.map(r => r.selector).filter(sel => !!sel).join(', ');\n    if (allSelectors) {\n      const shouldTraverse = el => el.querySelector(allSelectors);\n      this.shouldTraverse = shouldTraverse.bind(this);\n    } else {\n      this.shouldTraverse = () => false;\n    }\n  }\n\n  applySplitRules(original, clone, nextChild, deepClone) {\n    original.classList.add(classes.toNext);\n    clone.classList.add(classes.fromPrev);\n\n    this.didSplitRules.filter(r => original.matches(r.selector)).forEach((rule) => {\n      rule.didSplit(original, clone, nextChild, deepClone);\n    });\n  }\n\n  // Rules for pages\n  applyPageDoneRules(pg, book) {\n    this.pageRules.forEach(rule => rule.eachPage(pg, book));\n  }\n  finishEveryPage(book) {\n    this.pageRules.forEach(rule => book.pages.forEach(pg => rule.eachPage(pg, book)));\n  }\n\n  // Rules for elements\n  applyBeforeAddRules(element, book, continueOnNewPage, makeNewPage) {\n    let addedElement = element;\n\n    const matchingRules = this.beforeAddRules.filter(rule => addedElement.matches(rule.selector));\n\n    matchingRules.forEach((rule) => {\n      addedElement = rule.beforeAdd(addedElement, book, continueOnNewPage, makeNewPage);\n    });\n    return addedElement;\n  }\n\n  applyAfterAddRules(originalElement, book, continueOnNewPage, makeNewPage) {\n    let addedElement = originalElement;\n\n    const attemptRecovery = el => recoverFromRule(el, book, continueOnNewPage);\n    const matchingRules = this.afterAddRules.filter(rule => addedElement.matches(rule.selector));\n    const uniqueRules = dedupe(matchingRules);\n\n    uniqueRules.forEach((rule) => {\n      const retry = (el) => {\n        attemptRecovery(el);\n        return rule.afterAdd(el, book, continueOnNewPage, makeNewPage, () => giveUp(rule, el));\n      };\n      addedElement = rule.afterAdd(addedElement, book, continueOnNewPage, makeNewPage, retry);\n    });\n    return addedElement;\n  }\n}\n\nexport default RuleSet;\n","const sec = ms => (ms / 1000).toFixed(2);\n\nconst estimateFor = (content) => {\n  const start = window.performance.now();\n  const capacity = content.querySelectorAll('*').length;\n  let timeWaiting = 0;\n  let completed = 0;\n\n  return {\n    increment: () => { completed += 1; },\n    addWaitTime: (t) => { timeWaiting += t; },\n    get progress() { return completed / capacity; },\n    end: () => {\n      const end = window.performance.now();\n      const total = end - start;\n      const layout = total - timeWaiting;\n      console.log(`ðŸ“– Layout ready in ${sec(layout)}s (plus ${sec(timeWaiting)}s waiting for images)`);\n    },\n  };\n};\n\nexport default estimateFor;\n","import { flowIntoRegions } from 'regionize';\nimport { Book, Page, annotatePages } from '../book';\n\n// paginate\nimport RuleSet from './RuleSet';\nimport estimateFor from './estimateProgress';\n\nconst makeBook = async (content, rules, updateProgress) => {\n  if (!Page.isSizeValid()) throw Error('Page is too small');\n\n  const estimator = estimateFor(content);\n  const ruleSet = new RuleSet(rules);\n  const book = new Book();\n  const pageNumberOffset = ruleSet.pageNumberOffset;\n\n  const makeNewPage = () => new Page();\n\n  const finishPage = (page, allowOverflow) => {\n    // finished with this page, can display\n    book.updatePageOrder();\n    annotatePages(book.pages, pageNumberOffset);\n    ruleSet.applyPageDoneRules(page, book);\n    page.validateEnd(allowOverflow);\n    book.validate();\n  };\n\n  const addPageToBook = (allowOverflow = false) => {\n    const oldPage = book.currentPage;\n    if (oldPage) finishPage(oldPage, allowOverflow);\n\n    const newPage = makeNewPage();\n    book.currentPage = newPage;\n    book.addPage(newPage);\n\n    updateProgress(book, estimator.progress);\n    newPage.validate();\n    return newPage;\n  };\n\n  const makeNextRegion = () => {\n    const newPage = addPageToBook();\n    return newPage.flow;\n  };\n\n  const applySplit = ruleSet.applySplitRules;\n  const dontSplitSel = ruleSet.selectorsNotToSplit;\n  const canSplit = (element) => {\n    if (dontSplitSel.some(sel => element.matches(sel))) {\n      return false;\n    }\n    if (element.parentElement) return canSplit(element.parentElement, dontSplitSel);\n    return true;\n  };\n\n  const beforeAdd = (elementToAdd, continueInNextRegion) => {\n    ruleSet.applyBeforeAddRules(elementToAdd, book, continueInNextRegion, makeNewPage);\n  };\n\n  const afterAdd = (addedElement, continueInNextRegion) => {\n    estimator.increment();\n    return ruleSet.applyAfterAddRules(addedElement, book, continueInNextRegion, makeNewPage);\n  };\n\n  // init\n  content.style.margin = 0;\n  content.style.padding = 0;\n\n  await flowIntoRegions({\n    content,\n    createRegion: makeNextRegion,\n    applySplit,\n    canSplit,\n    beforeAdd,\n    afterAdd,\n    shouldTraverse: ruleSet.shouldTraverse,\n    didWaitFor: t => estimator.addWaitTime(t),\n  });\n\n  book.updatePageOrder();\n  annotatePages(book.pages, pageNumberOffset);\n\n  ruleSet.finishEveryPage(book);\n  estimator.end();\n  return book;\n};\n\n\nexport default makeBook;\n","const padPages = (pages, makePage) => {\n  if (pages.length % 2 !== 0) {\n    const pg = makePage();\n    pages.push(pg);\n  }\n  const spacerPage = makePage();\n  const spacerPage2 = makePage();\n  spacerPage.element.style.visibility = 'hidden';\n  spacerPage2.element.style.visibility = 'hidden';\n  pages.unshift(spacerPage);\n  pages.push(spacerPage2);\n\n  return pages;\n};\n\nexport default padPages;\n","import { Page } from '../book';\nimport { createEl } from '../dom-utils';\nimport padPages from './padPages';\n\nconst twoPageSpread = children => createEl('.spread-wrapper.spread-centered.spread-size', children);\nconst onePageSpread = children => createEl('.spread-wrapper.spread-centered.page-size', children);\n\nconst renderGridLayout = (bookPages, isTwoUp) => {\n  const pages = isTwoUp ? padPages(bookPages, () => new Page()) : bookPages;\n\n  const gridLayout = document.createDocumentFragment();\n  if (isTwoUp) {\n    for (let i = 0; i < pages.length; i += 2) {\n      const wrap = twoPageSpread([pages[i].element, pages[i + 1].element]);\n      gridLayout.appendChild(wrap);\n    }\n  } else {\n    pages.forEach((pg) => {\n      const wrap = onePageSpread([pg.element]);\n      gridLayout.appendChild(wrap);\n    });\n  }\n\n  return gridLayout;\n};\n\nexport default renderGridLayout;\n","import { createEl } from '../dom-utils';\n\nconst directions = ['top', 'bottom', 'left', 'right'];\nconst bleedMarks = () => directions.map(dir => createEl(`.mark-bleed-${dir}`));\nconst cropMarks = () => directions.map(dir => createEl(`.mark-crop-${dir}`));\n\nconst printMarksSingle = () => createEl('.page-size.print-mark-wrap', [\n  ...cropMarks(), ...bleedMarks(),\n]);\n\nconst printMarksSpread = () => createEl('.spread-size.print-mark-wrap', [\n  createEl('.mark-crop-fold'), ...cropMarks(), ...bleedMarks(),\n]);\n\nconst bookletMeta = (i, len) => {\n  const isFront = i % 4 === 0;\n  const sheetIndex = parseInt((i + 1) / 4, 10) + 1;\n  return createEl('.print-meta', `Sheet ${sheetIndex} of ${len / 4}: ${isFront ? 'Outside' : 'Inside'}`);\n};\n\nexport {\n  printMarksSingle,\n  printMarksSpread,\n  bookletMeta,\n};\n","const orderPagesBooklet = (pages, makePage) => {\n  while (pages.length % 4 !== 0) {\n    const spacerPage = makePage();\n    spacerPage.element.style.visibility = 'hidden';\n    pages.push(spacerPage);\n  }\n  const bookletOrder = [];\n  const len = pages.length;\n\n  for (let i = 0; i < len / 2; i += 2) {\n    bookletOrder.push(pages[len - 1 - i]);\n    bookletOrder.push(pages[i]);\n    bookletOrder.push(pages[i + 1]);\n    bookletOrder.push(pages[len - 2 - i]);\n  }\n\n  return bookletOrder;\n};\n\nexport default orderPagesBooklet;\n","import { createEl, classes } from '../dom-utils';\nimport { Page } from '../book';\nimport { Layout } from '../constants';\n\nimport { printMarksSingle, printMarksSpread, bookletMeta } from './printMarks';\nimport padPages from './padPages';\nimport orderPagesBooklet from './orderPagesBooklet';\n\nconst twoPageSpread = children => createEl('.spread-wrapper', children);\nconst onePageSpread = children => createEl('.spread-wrapper', children);\n\nconst renderPrintLayout = (bookPages, doubleSided, layout) => {\n  const isTwoUp = layout !== Layout.PAGES;\n  const isSpreads = layout === Layout.SPREADS;\n  const isBooklet = layout === Layout.BOOKLET;\n\n  let pages = bookPages;\n  if (isSpreads) pages = padPages(pages, () => new Page());\n  else if (isBooklet) pages = orderPagesBooklet(pages, () => new Page());\n\n  const printLayout = document.createDocumentFragment();\n\n  const marks = isTwoUp ? printMarksSpread : printMarksSingle;\n  const spread = isTwoUp ? twoPageSpread : onePageSpread;\n\n  const printSheet = children => createEl('print-sheet', [spread(children)]);\n\n  if (isTwoUp) {\n    for (let i = 0; i < pages.length; i += 2) {\n      const spreadMarks = marks();\n      if (isBooklet) {\n        const meta = bookletMeta(i, pages.length);\n        spreadMarks.appendChild(meta);\n      }\n      const sheet = printSheet([\n        createEl('.page-bleed-clip.page-bleed-clip-left', [pages[i].element]),\n        createEl('.page-bleed-clip.page-bleed-clip-right', [pages[i + 1].element]),\n        spreadMarks]);\n      sheet.classList.add(classes.sheetSpread);\n      printLayout.appendChild(sheet);\n    }\n  } else {\n    pages.forEach((pg) => {\n      const sheet = printSheet([pg.element, marks()]);\n      sheet.classList.add(pg.isLeft ? classes.sheetLeft : classes.sheetRight);\n      printLayout.appendChild(sheet);\n    });\n  }\n\n  return printLayout;\n};\n\nexport default renderPrintLayout;\n","import { Page } from '../book';\nimport { c, createEl } from '../dom-utils';\nimport padPages from './padPages';\n\nconst renderFlipLayout = (bookPages, doubleSided) => {\n  const pages = padPages(bookPages, () => new Page());\n\n  const flipLayout = document.createDocumentFragment();\n  const sizer = createEl('.spread-size.flip-sizer');\n  const flapHolder = createEl('.spread-size.flap-holder');\n  sizer.appendChild(flapHolder);\n  flipLayout.appendChild(sizer);\n  const flaps = [];\n  let currentLeaf = -1;\n\n  let leftOffset = 4;\n  if (pages.length * leftOffset > 60) {\n    leftOffset = 60 / pages.length;\n  }\n  flapHolder.style.width = `${pages.length * leftOffset}px`;\n\n  const setLeaf = (n) => {\n    let newLeaf = n;\n    if (newLeaf === currentLeaf) newLeaf += 1;\n    currentLeaf = newLeaf;\n\n    let zScale = 4;\n    if (flaps.length * zScale > 200) zScale = 200 / flaps.length;\n\n    flaps.forEach((flap, i, arr) => {\n      // + 0.5 so left and right are even\n      const z = (arr.length - Math.abs((i - newLeaf) + 0.5)) * zScale;\n      flap.style.transform = `translate3d(${(i < newLeaf) ? 4 : 0}px,0,${z}px) rotateY(${(i < newLeaf) ? -180 : 0}deg)`;\n    });\n  };\n\n  let leafIndex = 0;\n  for (let i = 1; i < pages.length - 1; i += (doubleSided ? 2 : 1)) {\n    leafIndex += 1;\n    const li = leafIndex;\n    const flap = createEl('.page3d');\n    flap.addEventListener('click', () => {\n      const newLeaf = li - 1;\n      setLeaf(newLeaf);\n    });\n\n    const rightPage = pages[i].element;\n    let leftPage;\n    rightPage.classList.add(c('page3d-front'));\n    flap.appendChild(rightPage);\n    if (doubleSided) {\n      flap.classList.add(c('doubleSided'));\n      leftPage = pages[i + 1].element;\n    } else {\n      leftPage = createEl('.page');\n    }\n    leftPage.classList.add(c('page3d-back'));\n    flap.appendChild(leftPage);\n\n    // TODO: Dynamically add/remove pages.\n    // Putting 1000s of elements onscreen\n    // locks up the browser.\n\n    flap.style.left = `${i * leftOffset}px`;\n\n    flaps.push(flap);\n    flapHolder.appendChild(flap);\n  }\n\n  setLeaf(0);\n  return flipLayout;\n};\n\nexport default renderFlipLayout;\n","const isCommandP = e => (e.ctrlKey || e.metaKey) && e.keyCode === 80;\n\n// Automatically switch into print mode\nconst listenForPrint = (beforePrint) => {\n  if (window.matchMedia) {\n    const mediaQueryList = window.matchMedia('print');\n    mediaQueryList.addListener((mql) => {\n      if (mql.matches) {\n        // before print\n        beforePrint();\n      } else {\n        // after print\n      }\n    });\n  }\n  document.body.addEventListener('keydown', (e) => {\n    if (isCommandP(e)) {\n      e.preventDefault();\n      beforePrint();\n      setTimeout(() => window.print(), 200);\n    }\n  });\n};\n\nexport default listenForPrint;\n","import { Page } from '../book';\nimport { Mode, Paper, Layout, Marks } from '../constants';\nimport { classes, createEl } from '../dom-utils';\nimport { throttleFrame, throttleTime } from '../utils';\nimport { gridLayout, printLayout, flipLayout } from '../layouts';\n\nimport errorView from './error';\nimport listenForPrint from './listenForPrint';\n\nconst throttleProgressBar = throttleFrame();\nconst throttleRender = throttleTime(100);\nconst throttleResize = throttleTime(50);\nconst document = window.document;\n\nclass Viewer {\n  constructor({ pageSetup, mode, layout, marks, ControlsComponent }) {\n    this.book = null;\n    this.pageSetup = pageSetup;\n\n    this.progressBar = createEl('progress-bar');\n    this.content = createEl('zoom-content');\n    this.scaler = createEl('zoom-scaler', [this.content]);\n    this.element = createEl('root', [this.progressBar, this.scaler]);\n\n    this.doubleSided = true;\n    this.layout = layout;\n\n    this.setMarks(marks);\n    this.mode = mode;\n    this.element.classList.add(classes.viewPreview);\n    this.currentLeaf = 0;\n\n    listenForPrint(() => {\n      this.mode = Mode.PRINT;\n      this.render();\n    });\n\n    window.addEventListener('resize', () => {\n      throttleResize(() => this.scaleToFit());\n    });\n\n    if (ControlsComponent) {\n      this.controls = new ControlsComponent(\n        { Mode, Paper, Layout, Marks }, // Available options\n        { // Initial props\n          paper: this.pageSetup.paper,\n          layout: this.layout,\n          mode: this.mode,\n          marks,\n        },\n        { // Actions\n          setMode: this.setMode.bind(this),\n          setPaper: this.setSheetSize.bind(this),\n          setLayout: this.setLayout.bind(this),\n          setMarks: this.setMarks.bind(this),\n          getPageSize: () => this.pageSetup.displaySize,\n        }\n      );\n      this.element.appendChild(this.controls.element);\n    }\n\n    this.inProgress = true;\n\n    this.show();\n  }\n\n  setMode(newVal) {\n    const newMode = parseInt(newVal, 10);\n    if (newMode === this.mode) return;\n    this.mode = newMode;\n    this.render();\n  }\n\n  get inProgress() {\n    return this.element.classList.contains(classes.inProgress);\n  }\n\n  set inProgress(newVal) {\n    this.element.classList.toggle(classes.inProgress, newVal);\n    if (newVal && this.controls) this.controls.setInProgress();\n  }\n\n  get isTwoUp() {\n    return this.layout !== Layout.PAGES;\n  }\n\n  get isShowingCropMarks() {\n    return this.element.classList.contains(classes.showCrop);\n  }\n\n  set isShowingCropMarks(newVal) {\n    this.element.classList.toggle(classes.showCrop, newVal);\n  }\n\n  get isShowingBleedMarks() {\n    return this.element.classList.contains(classes.showBleedMarks);\n  }\n\n  set isShowingBleedMarks(newVal) {\n    this.element.classList.toggle(classes.showBleedMarks, newVal);\n  }\n\n  get isShowingBleed() {\n    return this.element.classList.contains(classes.showBleed);\n  }\n\n  set isShowingBleed(newVal) {\n    this.element.classList.toggle(classes.showBleed, newVal);\n  }\n\n  get isViewing() {\n    return document.body.classList.contains(classes.isViewing);\n  }\n\n  set isViewing(newVal) {\n    document.body.classList.toggle(classes.isViewing, newVal);\n  }\n\n  setSheetSize(str) {\n    const newVal = parseInt(str, 10);\n\n    this.pageSetup.paper = newVal;\n    this.pageSetup.updateStyleVars();\n\n    this.mode = Mode.PRINT;\n    this.render();\n\n    this.scaleToFit();\n    setTimeout(() => { this.scaleToFit(); }, 300);\n  }\n\n  setLayout(str) {\n    const newVal = parseInt(str, 10);\n\n    if (newVal === this.layout) return;\n    this.layout = newVal;\n\n    this.pageSetup.printTwoUp = this.isTwoUp;\n    this.pageSetup.updateStyleVars();\n\n    this.mode = Mode.PRINT;\n    this.render();\n  }\n\n  setMarks(str) {\n    const newVal = parseInt(str, 10);\n    this.isShowingCropMarks = (newVal === Marks.CROP || newVal === Marks.BOTH);\n    this.isShowingBleedMarks = (newVal === Marks.BLEED || newVal === Marks.BOTH);\n  }\n\n  displayError(title, text) {\n    this.show();\n    if (!this.error) {\n      this.error = errorView(title, text);\n      this.element.appendChild(this.error);\n      this.scrollToBottom();\n      if (this.book) {\n        const flow = this.book.currentPage.flow;\n        if (flow) flow.currentElement.style.outline = '3px solid red';\n      }\n    }\n  }\n\n  scrollToBottom() {\n    const scroll = document.scrollingElement;\n    if (!scroll) return;\n    const scrollMax = scroll.scrollHeight - scroll.offsetHeight;\n    scroll.scrollTop = scrollMax;\n  }\n\n  clear() {\n    this.book = null;\n    this.lastSpreadInProgress = null; // TODO: Make this clearer, after first render\n    this.content.innerHTML = '';\n  }\n\n  show() {\n    if (this.element.parentNode) return;\n    document.body.appendChild(this.element);\n    this.isViewing = true;\n  }\n\n  hide() {\n    // TODO this doesn't work if the target is an existing node\n    if (!this.element.parentNode) return;\n    this.element.parentNode.removeChild(this.element);\n    this.isViewing = false;\n  }\n\n  render(newBook) {\n    if (newBook) this.book = newBook;\n    if (!this.book) return;\n    this.show();\n\n    this.element.classList.remove(...classes.allModes);\n    this.element.classList.add(classes[this.mode]);\n    this.isShowingBleed = this.mode === Mode.PRINT;\n\n    const prevScroll = this.scrollPercent;\n\n    if (this.controls) this.controls.setDone(this.book.pages.length);\n    this.progress = 1;\n\n    window.requestAnimationFrame(() => {\n      const pages = this.book.pages.slice();\n      const fragment = this.viewFor(this.mode)(pages, this.doubleSided, this.layout);\n      this.content.innerHTML = '';\n      this.content.appendChild(fragment);\n      if (!this.hasRendered) this.hasRendered = true;\n      else this.scrollPercent = prevScroll;\n\n      this.scaleToFit();\n    });\n  }\n\n  viewFor(mode) {\n    if (mode === Mode.PREVIEW) return gridLayout;\n    else if (mode === Mode.FLIPBOOK) return flipLayout;\n    else if (mode === Mode.PRINT) return printLayout;\n    throw Error(`Invalid layout mode: ${this.mode} (type ${typeof this.mode})`);\n  }\n\n  set progress(p) {\n    if (p < 1) {\n      throttleProgressBar(() => {\n        this.progressBar.style.transform = `scaleX(${p})`;\n      });\n    } else {\n      this.progressBar.style.transform = '';\n    }\n  }\n\n  updateProgress(book, estimatedProgress) {\n    this.book = book;\n    this.progress = estimatedProgress;\n\n    if (!document || !document.scrollingElement) return;\n    // don't rerender if preview is out of view\n    const scrollTop = document.scrollingElement.scrollTop;\n    const scrollH = document.scrollingElement.scrollHeight;\n    const h = document.scrollingElement.offsetHeight;\n    if (scrollH > h * 3 && scrollTop < h) return;\n\n    // don't rerender too often\n    throttleRender(() => this.renderProgress(book, estimatedProgress));\n  }\n\n  renderProgress(book, estimatedProgress) {\n    const needsZoomUpdate = !this.content.firstElementChild;\n\n    if (this.controls) {\n      this.controls.updateProgress(book.pageCount, estimatedProgress);\n    }\n\n    const sideBySide =\n      this.mode === Mode.PREVIEW\n      || (this.mode === Mode.PRINT && this.layout !== Layout.PAGES);\n    const limit = sideBySide ? 2 : 1;\n\n    const makeSpread = pgs => createEl('.spread-wrapper.spread-centered.spread-size', pgs);\n\n    book.pages.forEach((page, i) => {\n      if (this.content.contains(page.element) && page.element.parentNode !== this.content) return;\n      if (this.lastSpreadInProgress && this.lastSpreadInProgress.children.length < limit) {\n        this.lastSpreadInProgress.appendChild(page.element);\n        return;\n      }\n      this.lastSpreadInProgress = makeSpread([page.element]);\n      if (i === 0 && sideBySide) {\n        const spacer = new Page();\n        spacer.element.style.visibility = 'hidden';\n        this.lastSpreadInProgress.insertBefore(\n          spacer.element,\n          this.lastSpreadInProgress.firstElementChild\n        );\n      }\n      this.content.appendChild(this.lastSpreadInProgress);\n    });\n\n    if (needsZoomUpdate) this.scaleToFit();\n  }\n\n  scaleToFit() {\n    if (!this.content.firstElementChild) return;\n    const prevScroll = this.scrollPercent;\n    this.scaler.style.transform = `scale(${this.scaleThatFits})`;\n    this.scrollPercent = prevScroll;\n  }\n\n  get scaleThatFits() {\n    const viewerW = this.scaler.getBoundingClientRect().width;\n    const contentW = this.content.getBoundingClientRect().width;\n    return Math.min(1, viewerW / contentW);\n  }\n\n  get scrollPercent() {\n    if (!document || !document.scrollingElement) return 0;\n    const el = document.scrollingElement;\n    return el.scrollTop / el.scrollHeight;\n  }\n\n  set scrollPercent(newVal) {\n    if (!document || !document.scrollingElement) return;\n    const el = document.scrollingElement;\n    el.scrollTop = el.scrollHeight * newVal;\n  }\n}\n\nexport default Viewer;\n","/* global BINDERY_VERSION */\n\n// main\nimport PageSetup from './page-setup';\nimport { Mode, Paper, Layout, Marks } from './constants';\nimport defaultRules from './defaults';\n\n// components\nimport makeBook from './makeBook';\nimport Viewer from './viewer';\nimport rules from './rules';\nimport { validate, T } from './option-checker';\nimport { parseHTML } from './dom-utils';\n\nconst vals = obj => Object.keys(obj).map(k => obj[k]);\nconst rAF = () => new Promise((resolve) => {\n  requestAnimationFrame(t => resolve(t));\n});\n\nclass Bindery {\n  constructor(opts = {}) {\n    console.log(`ðŸ“– Bindery ${BINDERY_VERSION}`);\n\n    if (!opts.content) {\n      this.viewer.displayError('Content not specified', 'You must include a source element, selector, or url');\n      throw Error('Bindery: You must include a source element or selector');\n    }\n\n    this.autorun = opts.autorun || true;\n    this.autoupdate = opts.autoupdate || false;\n\n    validate(opts, {\n      name: 'makeBook',\n      autorun: T.bool,\n      content: T.any,\n      ControlsComponent: T.func,\n      view: T.enum(...vals(Mode)),\n      pageNumberOffset: T.number,\n      pageSetup: T.shape({\n        name: 'pageSetup',\n        margin: T.margin,\n        size: T.size,\n      }),\n      printSetup: T.shape({\n        name: 'printSetup',\n        bleed: T.length,\n        layout: T.enum(...vals(Layout)),\n        marks: T.enum(...vals(Marks)),\n        paper: T.enum(...vals(Paper)),\n      }),\n      rules: T.array,\n    });\n\n    this.pageSetup = new PageSetup(opts.pageSetup, opts.printSetup);\n\n    const startLayout = opts.printSetup ? opts.printSetup.layout || Layout.PAGES : Layout.PAGES;\n    const startMarks = opts.printSetup ? opts.printSetup.marks || Marks.CROP : Marks.CROP;\n    const controls = opts.ControlsComponent || window.BinderyControls;\n    this.viewer = new Viewer({\n      pageSetup: this.pageSetup,\n      mode: opts.view || Mode.PREVIEW,\n      marks: startMarks,\n      layout: startLayout,\n      ControlsComponent: controls,\n    });\n\n    this.rules = defaultRules;\n    this.rules.push({ pageNumberOffset: opts.pageNumberOffset || 0 });\n    if (opts.rules) this.addRules(opts.rules);\n\n    this.getContentAsElement(opts.content).then((el) => {\n      this.content = el;\n      if (el && this.autorun) this.makeBook();\n    });\n  }\n\n  // Convenience constructor\n  static makeBook(opts = {}) {\n    opts.autorun = opts.autorun ? opts.autorun : true;\n    return new Bindery(opts);\n  }\n\n  async getContentAsElement(content) {\n    if (content instanceof HTMLElement) return content;\n    if (typeof content === 'string') {\n      const el = document.querySelector(content);\n      if (!(el instanceof HTMLElement)) {\n        this.viewer.displayError('Content not specified', `Could not find element that matches selector \"${content}\"`);\n        console.error(`Bindery: Could not find element that matches selector \"${content}\"`);\n      }\n      return el;\n    }\n    if (typeof content === 'object' && content.url) {\n      return this.fetchContent(content.url, content.selector);\n    }\n    throw Error('Bindery: Source must be an element or selector');\n  }\n\n  async fetchContent(url, sel) {\n    const response = await fetch(url);\n    if (response.status !== 200) {\n      this.viewer.displayError(response.status, `Could not find file at \"${url}\"`);\n      throw Error(`Bindery: Could not find file at \"${url}\"`);\n    }\n    const fetchedContent = await response.text();\n    const el = parseHTML(fetchedContent, sel);\n    if (!(el instanceof HTMLElement)) {\n      this.viewer.displayError(\n        'Source not specified',\n        `Could not find element that matches selector \"${sel}\"`\n      );\n      throw Error(`Bindery: Could not find element that matches selector \"${sel}\"`);\n    }\n    return el;\n  }\n\n  cancel() {\n    this.viewer.hide();\n    if (this.content) this.content.style.display = '';\n  }\n\n  addRules(newRules) {\n    newRules.forEach((rule) => {\n      if (rule instanceof rules.Rule) {\n        this.rules.push(rule);\n      } else {\n        throw Error(`Bindery: The following is not an instance of Bindery.Rule and will be ignored: ${rule}`);\n      }\n    });\n  }\n\n  async makeBook() {\n    if (!this.content) {\n      this.viewer.show();\n      console.error('No content');\n      return null;\n    }\n\n    this.content.style.display = '';\n    const content = this.content.cloneNode(true);\n    this.content.style.display = 'none';\n\n    this.layoutInProgress = true;\n    this.viewer.clear(); // In case we're updating an existing layout\n    this.viewer.show();\n    this.pageSetup.updateStyleVars();\n    this.viewer.inProgress = true;\n\n    try {\n      const onProgress = (current, progress) => this.viewer.updateProgress(current, progress);\n      const book = await makeBook(content, this.rules, onProgress);\n      this.viewer.progress = 1;\n      this.layoutInProgress = false;\n      await rAF();\n      this.viewer.render(book);\n      this.viewer.inProgress = false;\n      return book;\n    } catch (e) {\n      this.layoutInProgress = false;\n      this.viewer.inProgress = false;\n      this.viewer.displayError('Layout couldn\\'t complete', e.message);\n      console.error(e);\n      return null;\n    }\n  }\n}\n\nexport default Bindery;\n","/* global BINDERY_VERSION */\nimport Bindery from './bindery';\nimport rules from './rules';\nimport { Mode, Paper, Layout, Marks } from './constants';\nimport './main.scss';\n\n\nconst BinderyWithRules = Object.assign(Bindery, rules);\nBinderyWithRules.View = Mode;\nBinderyWithRules.Paper = Paper;\nBinderyWithRules.Layout = Layout;\nBinderyWithRules.Marks = Marks;\nBinderyWithRules.version = BINDERY_VERSION;\n\nexport default BinderyWithRules;\n"],"names":["title","text","createEl","BINDERY_VERSION","prefix","str","prefixClass","prefixer","substr","AUTO","AUTO_BLEED","AUTO_MARKS","LETTER_PORTRAIT","LETTER_LANDSCAPE","A4_PORTRAIT","A4_LANDSCAPE","PREVIEW","PRINT","PAGES","SPREADS","BOOKLET","CROP","BLEED","BOTH","classes","showBleed","showCrop","showBleedMarks","isViewing","viewPreview","viewPrint","viewFlip","inProgress","leftPage","rightPage","isOverflowing","printSheet","sheetSpread","sheetLeft","sheetRight","toNext","fromPrev","Object","keys","forEach","k","val","allModes","Mode.PREVIEW","Mode.PRINT","doc","window","document","className","content","div","createElement","split","filter","txt","map","join","textContent","Array","isArray","child","appendChild","safeMeasure","el","measure","parentNode","measureArea","querySelector","c","body","firstElementChild","innerHTML","result","addStylesheet","id","style","head","stylesheet","parseHTML","selector","wrapper","cssNumberRegEx","isLength","test","parseLength","Error","matches","match","unit","bleed","size","width","height","margin","inner","outer","bottom","top","letter","freeze","a4","supportsCustomPageSize","chrome","PageSetup","constructor","opts","printOpts","defaultPageSetup","markLength","paper","Paper.AUTO","Paper.AUTO_MARKS","printTwoUp","layout","Layout.PAGES","displaySize","spreadSize","sheetSize","doubleBleed","doubleMarks","singleMarks","Paper.AUTO_BLEED","Paper.LETTER_LANDSCAPE","Paper.LETTER_PORTRAIT","Paper.A4_PORTRAIT","Paper.A4_LANDSCAPE","w","updateStyleVars","page","sheet","vars","pageRule","Rule","options","name","key","validate","validOpts","setName","type","check","optName","JSON","stringify","isObj","hasProp","obj","prototype","hasOwnProperty","call","hasSameKeys","required","some","isShape","template","input","isShapeExact","isEnum","cases","includes","T","any","enum","shapeExact","shape","string","length","number","bool","func","array","Counter","counterValue","replaceEl","resetEl","incrementEl","replace","setup","beforeAdd","createReplacement","element","OutOfFlow","elmt","setAttribute","afterAdd","book","continueOnNewPage","makeNewPage","createOutOfFlowPages","continue","currentPage","hasOutOfFlowContent","setPreference","FullBleedSpread","rotate","removeChild","isEmpty","addPage","rotateContainer","background","classList","add","isOutOfFlow","avoidReorder","cloneNode","FullBleedPage","newPage","Replace","overflowCallback","parent","console","error","defensiveClone","replacement","replaceChild","hasOverflowed","insertAdjacentHTML","Footnote","render","footer","children","footnote","contents","HTMLElement","overflowEl","pageNumbersForTest","pages","pg","formatAsRanges","pageNumbers","prevNum","isInARange","addFirst","num","continueRange","endRange","endNum","addComma","endAndAdd","addLast","isAdjacent","i","isLast","shallowEqual","a","b","len","throttleTime","time","queued","wasCalled","setTimeout","queuedFunc","startsNum","sel","safeIDSel","PageReference","createTest","references","throttle","throttledUpdate","updatePageReferences","eachPage","ref","createReference","value","newValue","push","currentResults","isResolved","pageRanges","newRender","href","getAttribute","results","data","PageBreak","position","avoidSplit","RunningHeader","runningHeader","Split","fromPrevious","didSplit","original","clone","createRule","rules","replacer","term","toLowerCase","trim","cls","Region","padding","path","setPath","newPath","currentElement","offsetHeight","isReasonableSize","box","getBoundingClientRect","overflowAmount","contentH","boxH","isTextNode","node","nodeType","Node","TEXT_NODE","isElement","ELEMENT_NODE","isScript","tagName","isImage","isUnloadedImage","naturalWidth","isContentElement","rAF","Promise","resolve","requestAnimationFrame","t","lastYieldTime","shouldYield","timeSinceYield","performance","now","yieldIfNecessary","ignoreOverflow","hasAttribute","parentElement","createTextNode","bind","addTextNode","textNode","success","addTextNodeUntilOverflow","originalText","nodeValue","pos","charAt","fittingText","overflowingText","remainingTextNode","addTextNodeAcrossParents","nextParent","nextElement","tryInNextRegion","region","makeNextRegion","canSplit","startLength","elementToMove","pop","nearestElementThatCanBeMoved","pathToRestore","unshift","nextRegion","suppressErrors","r","clonePath","oldPath","applyRules","deepClone","nextChild","wait10","ensureImageLoaded","image","imgStart","failed","addEventListener","src","preserveNumbering","prevStart","parseInt","prevCount","newStart","preserveTableColumns","columns","currentIndex","indexOf","clonedCol","noop","always","never","flowIntoRegions","createRegion","applySplit","didWaitFor","shouldTraverse","currentRegion","canSplitCurrent","ignoreCurrentOverflow","splitRules","prev","next","continueInNextRegion","oldBox","continuedParent","addTextWithoutChecks","addSplittableTextNode","hasAdded","addWholeTextNode","canSkipTraversal","containsImage","safeAddElementNode","addElementNode","childNodes","shouldSplit","waitTime","addedElement","Page","flow","isSizeValid","testPage","setLeftRight","dir","side","toggle","isLeft","isRight","preferLeft","alwaysLeft","alwaysRight","suppress","newVal","suspect","warn","validateEnd","allowOverflow","indexOfNextReorderablePage","startIndex","orderPages","orderedPages","slice","indexToSwap","pageToMoveUp","splice","Book","rawPages","updatePageOrder","pageCount","annotatePages","offset","running","h1","h2","h3","h4","h5","h6","heading","tag","j","isSpread","rule","isPage","isBreak","isFullPageRule","dedupe","inputRules","conflictRules","output","firstSpreadRule","find","firstPageRule","recoverFromRule","nextBox","removed","popped","newBox","giveUp","RuleSet","offsetRule","pageNumberOffset","pageRules","beforeAddRules","afterAddRules","selectorsNotToSplit","didSplitRules","applySplitRules","allSelectors","applyPageDoneRules","finishEveryPage","applyBeforeAddRules","matchingRules","applyAfterAddRules","originalElement","attemptRecovery","uniqueRules","sec","ms","toFixed","estimateFor","start","capacity","querySelectorAll","timeWaiting","completed","increment","addWaitTime","progress","end","log","makeBook","updateProgress","estimator","ruleSet","finishPage","addPageToBook","oldPage","dontSplitSel","elementToAdd","padPages","makePage","spacerPage","spacerPage2","visibility","twoPageSpread","onePageSpread","renderGridLayout","bookPages","isTwoUp","gridLayout","createDocumentFragment","wrap","directions","bleedMarks","cropMarks","printMarksSingle","printMarksSpread","bookletMeta","sheetIndex","orderPagesBooklet","bookletOrder","renderPrintLayout","doubleSided","isBooklet","Layout.BOOKLET","Layout.SPREADS","printLayout","marks","spread","spreadMarks","meta","renderFlipLayout","flipLayout","sizer","flapHolder","flaps","currentLeaf","leftOffset","setLeaf","n","newLeaf","zScale","flap","arr","Math","abs","z","transform","leafIndex","li","left","isCommandP","e","ctrlKey","metaKey","keyCode","listenForPrint","beforePrint","matchMedia","mediaQueryList","addListener","mql","preventDefault","print","throttleProgressBar","throttleRender","throttleResize","Viewer","pageSetup","mode","ControlsComponent","progressBar","scaler","setMarks","scaleToFit","controls","Mode","Paper","Layout","Marks","setMode","setPaper","setSheetSize","setLayout","getPageSize","show","newMode","contains","setInProgress","isShowingCropMarks","isShowingBleedMarks","isShowingBleed","Marks.CROP","Marks.BOTH","Marks.BLEED","displayError","errorView","scrollToBottom","outline","scroll","scrollingElement","scrollMax","scrollHeight","scrollTop","clear","lastSpreadInProgress","hide","newBook","remove","prevScroll","scrollPercent","setDone","fragment","viewFor","hasRendered","p","estimatedProgress","scrollH","h","renderProgress","needsZoomUpdate","sideBySide","limit","makeSpread","pgs","spacer","insertBefore","scaleThatFits","min","viewerW","contentW","vals","Bindery","viewer","autorun","autoupdate","view","printSetup","startLayout","startMarks","BinderyControls","defaultRules","addRules","getContentAsElement","then","url","fetchContent","response","fetch","status","fetchedContent","cancel","display","newRules","layoutInProgress","current","message","BinderyWithRules","assign","View","version"],"mappings":"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"}